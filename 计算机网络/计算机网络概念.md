### 计算机网络基础知识

***

1. ##### OSI与TCP/IP各层的结构与功能，都有哪些协议？

   - **应用层：**通过应用进程间的交互来完成特定网络应用。
     - 相关协议：域名系统DNS，HTTP协议，FTP协议，SMTP协议，TELNET协议。
   - **运输层：**负责向两台主机进程之间的通信提供通用的数据传输服务。应用程序利用该服务传送应用层报文。
     - 相关协议：TCP协议（传送字节流），UDP协议（传送用户数据报）。
   - **网络层：**选择合适的网间路由器和交换节点，确保数据及时传送。
     - 相关协议：IP协议（传送IP数据报/分组），ICMP，IGMP协议，RIP（动态路由选择协议，跳数），OSPF协议（开放最短路径协议）
   - **数据链路层**：将网络层交下来的的IP数据报组装成帧，在相邻的两个节点间的链路上传送帧。
     - 相关协议：PPP协议（点到点），Ethernet协议（以太网），ARP（地址解析协议，IP地址->物理地址），RARP（传送帧），CSMA/CD协议(载波监听多点接入/碰撞检测)
   - **物理层：**实现相邻计算机节点间比特流的透明传输，尽可能屏蔽掉具体传输介质和物理设备的差异。透明传输比特流 表示经过实际电路传送后的比特流没有发生变化，对传送的比特流来说，这个电路好像是看不见的。
     - 相关协议：与硬件相关的协议（传送比特流）

2. ##### 说一下TCP三次握手和四次挥手。

   - **三次握手：**通信双方通过三次握手建立可靠的通信机制，互相确认自己与对方的发送与接是正常的。
   
     - 客户端->发送SYN标志的数据包->服务端
     - 服务端->发送SYN/ACK标志的数据包->客户端
     - 客户端->发送带有ACK标志的数据包->服务端
   
     ![](https://img-blog.csdn.net/20170605110405666?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXpjc3U=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
   
   - **四次挥手：**任何一方都可以在数据传送结束后发出连接释放的通知，待对方确认后进入半关闭状态。当另一方也没有数据在发送的时候，则发出连接释放通知，双方确认后就完全关闭了TCP连接。
   
     - 客户端->发送一个FIN->服务端，用来关闭客户端到服务器的数据传送。
     - 服务端->收到这个FIN，回发ACK->客户端
     - 服务端->发送一个FIN->客户端，用来关闭服务端和客户端的连接。
     - 客户端->回发ACK报文确认->服务端
   
     ![](https://img-blog.csdn.net/20170606084851272?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXpjc3U=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
   
3. ##### TCP,UDP协议的区别

   - TCP：面向连接，传输可靠，传输字节流，传输慢，所需资源多，应用场景要求通信数据可靠。
   - UDP：无连接，传输不可靠，传输数据报文段，传输快，所需资源少，应用场景要求通信速度高。

4. ##### TCP协议如何保证数据可靠传输？

   - 数据被分割为TCP认为最合适发送的数据块。
   - TCP给发送的每一个包进行编号，接收方对数据包进行排序，把有序数据发送给应用层。
   - 校验和：TCP将保持它首部和数据的检验和。检验和有差错，TCP将丢弃这个报文段。
   - TCP接收端丢弃重复的数据。
   - 流量控制（滑动窗口实现）：TCP连接的每一方都有固定大小的缓冲空间，TCP接收端只允许发送端发送接收缓冲区能接纳的数据。让发送方降低传输速率，避免丢包。
   - 拥塞控制：慢开始，拥塞避免，快重传，快恢复
   - ARQ协议：每发送完一个分组，就停止发送，等待对方确认。收到确认后在发送下一个分组。
   - 超时重传：TCP发出一个段后，他启动一个定时器，等待目的端确认收到这个报文段。如果不能及时收到一个确认，超过时间将重发这个报文段。

5. ##### ARQ协议。

   自动重传请求是OSI模型中数据链路层和传输层的错误纠正协议之一。它通过使用确认和超时这两个机制，在不可靠服务的基础上实现可靠的信息传输。如果发送方在发送一段时间之内没有收到确认帧，他会重新发送。ARQ协议包括停止等待ARQ协议和连续ARQ协议。

  - 停止等待ARQ协议：每发送完一个分组就停止发送，等待对方确认（回复ACK）。超时重传。若接收方收到重复分组，就丢弃该分组，但同时还要发送确认。
  - 连续ARQ协议：发送发维持一个发送窗口，凡位于发送窗口内的分组可以连续发送出去，而不需要等待对方确认。接收方一般采用累计确认，对按序到达的最后一个分组发送确认，表明到这个分组为止的所有分组都已经正确收到了。信道利用率高。

6. ##### 在浏览器中输入url地址会发生什么?

   - DNS解析：域名服务器解析，将网址转换IP地址。
   - TCP连接：传输层协议。
   - 发送HTTP请求：HTTP报文在TCP报文中，服务端会解包提取HTTP报文。
   - 服务器处理请求并返回HTTP报文：Web服务器完成，返回响应报文（状态码+响应报头+响应报文）
   - 浏览器解析渲染页面：浏览器解析HTTP文件构建DOM树，解析CSS文件构建渲染树，在布局渲染树到页面。
   - 连接结束

7. ##### 状态码了解么？

   - 1xx：信息性状态码–表示请求已接收，正在处理。
   - 2xx：成功状态码–表示请求已被成功接收、理解。
   - 3xx：重定向状态码–要完成请求必须进行更进一步的操作。
   - 4xx：客户端错误状态码–请求有语法错误或请求无法实现。
   - 5xx：服务器端错误状态码–服务器未能实现合法的请求。

8. ##### URI和URL的区别是什么？

   - URI：统一资源标识符，可以唯一标识一个资源。
   - URL：统一资源定位符，提供一个资源的路径。

9. ##### HTTP和HTTPS的区别？

   - 端口：HTTP的URL由`http://`起始，且默认端口为80；HTTPS的URL由`https://`起始，默认端口443。
   - 安全性：HTTP协议运行在TCP之上，所有传输的内容都是明文传输，客户端和服务器都无法验证对方的身份。HTTPS协议是运行在SSL/TLS+TCP之上，所有传输的内容均经过加密。

10. ##### Cookie的作用是什么?和Session有什么区别？

   Cookie和Session都是用来跟踪浏览器用户身份的会话方式，但应用场景不一样。

   **Cookie一般用来保存用户信息，保存在浏览器**：

   - Cookie中保存登录信息，下次访问网站可以识别一些基本信息。
   - 若登陆时存放了Token在Cookie中，下次登陆就可以根据Token值来查找用户，直接登录。

   **Session主要通过服务端记录用户的状态，保存在服务器端。**

11. ##### Token和SessionID的区别？

    客户端登录成功后， 服务器为其分配sessionId, 客户端随后每次请求资源时都带上sessionId。服务器判断用户是否登录， 完全依赖于sessionId, 一旦其被截获， 黑客就能够模拟出用户的请求。

    于是我们需要引入token的概念： 用户登录成功后， 服务器不但为其分配了sessionId, 还分配了token， **token是维持登录状态的关键秘密数据**。在服务器向客户端发送的token数据，也需要加密，服务端为userID进行加密。

    确定用户可以登录后，生成sessionId和token， 同时利用客户端发送的公钥，对token进行加密。最后将sessionId和加密后的token返还给客户端。客户端利用自己生成的私钥对token密文解密， 得到真正的token。 

12. ##### HTTP是不保存状态的协议，那如何保存用户的状态？

    HTTP是一种无状态协议，即HTTP协议自身不对请求和响应之间的通信状态进行保存。解决办法就是Session机制，通过服务器端记录用户的状态。服务器端给用户创建特定的Session之后就可以表示这个用户并跟踪这个用户。

    Session的跟踪通过SessionID实现，SessionID一般存放在Cookie中，用户访问服务器端解析出SessionID并在数据库内从中找到这个SessionID就可以找到对应的Session。
    
13. ##### 说一说路由器和交换机的区别。

    - 交换机主要工作在数据链路层，传输的是数据帧；路由器主要工作在网络层，转发的是数据报文。
    - 交换机基于MAC地址寻址，路由器基于IP地址寻址。
    - 交换机分割冲突域，不划分广播域，即隶属一个交换机的主机属于一个冲突域。路由器可以划分广播域 。

14. ##### 广播域和冲突域是什么？

    - 冲突域：连接在同一导线上的所有工作站的集合，或者说是同一物理网段上所有节点的集合或以太网上竞争同一带宽的节点集合，主要在数据链路层。
    - 广播域： 接收同样广播消息的节点的集合。 

